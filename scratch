# Define variables for software name and path to installation file
$SoftwareName = "CustomSoftware"
$SoftwarePath = "\\server\share\CustomSoftware.msi"

# Read the list of computers from a text file
$Computers = Get-Content -Path "C:\computers.txt"

# Loop through each computer in the list and install the software
foreach ($Computer in $Computers) {
    # Construct the UNC path to the administrative share (C$)
    $AdminShare = "\\" + $Computer + "\C$"

    # Check if the administrative share is accessible
    if (Test-Path $AdminShare) {
        # Construct the path to the installation file on the remote computer
        $RemotePath = $AdminShare + "\" + $SoftwareName + ".msi"

        # Copy the installation file to the remote computer
        Copy-Item $SoftwarePath -Destination $RemotePath -Force

        # Install the software silently using MSIEXEC
        $Arguments = "/i `"$RemotePath`" /quiet"
        $Process = [System.Diagnostics.Process]::Start("msiexec.exe", $Arguments)
        $Process.WaitForExit()
    }
    else {
        Write-Warning "Unable to connect to $Computer"
    }
}
